<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="acledR">
<title>Deletions API: Keeping your dataset up to date • acledR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deletions API: Keeping your dataset up to date">
<meta property="og:description" content="acledR">
<meta property="og:image" content="https://billingtt.github.io/acledR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">acledR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/get_started.html">Get Started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-utilizing-acledr">Utilizing acledR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-utilizing-acledr">
    <a class="dropdown-item" href="../articles/acled_api.html">ACLED API</a>
    <a class="dropdown-item" href="../articles/acled_deletions_api.html">Keeping your dataset updated</a>
    <a class="dropdown-item" href="../articles/generate_counts.html">Generate Event Counts</a>
    <a class="dropdown-item" href="../articles/generate_movers.html">Generate Moving Statistics</a>
    <a class="dropdown-item" href="../articles/acled_actor_concentration.html">Calculate Actor Indexes</a>
    <a class="dropdown-item" href="../articles/acled_transformations.html">acledR Data Manipulation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-acled-codebook">ACLED Codebook</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-acled-codebook">
    <a class="dropdown-item" href="../articles/acled_codebook.html">Overview</a>
    <a class="dropdown-item" href="../articles/event_types.html">Event and Sub-Event Types</a>
    <a class="dropdown-item" href="../articles/actors_interactions.html">Actors and Interactions</a>
    <a class="dropdown-item" href="../articles/time.html">Time</a>
    <a class="dropdown-item" href="../articles/geography.html">Geography</a>
    <a class="dropdown-item" href="../articles/acled_sources.html">Sources</a>
    <a class="dropdown-item" href="../articles/fatalities.html">Fatalities</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/billingtt/acledR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Deletions API: Keeping your dataset up to date</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/billingtt/acledR/blob/HEAD/vignettes/articles/acled_deletions_api.Rmd" class="external-link"><code>vignettes/articles/acled_deletions_api.Rmd</code></a></small>
      <div class="d-none name"><code>acled_deletions_api.Rmd</code></div>
    </div>

    
    
<p>ACLED is a living dataset, which means changes happen often.</p>
<p>Three types of changes are recurrent in ACLED’s dataset:</p>
<ul>
<li>New events
<ul>
<li>These are the weekly updates of events, all are published with a new
distinctive id (in the event_id_cnty column).</li>
</ul>
</li>
<li>Modification of previous events
<ul>
<li>In some cases we are required to do modifications to published
events, as new information may appear. For example, a particular actor
has claimed responsibility over an attack, or the number of fatalities
has changed. In these cases, the event_id_cnty remains the same, but the
new information is updated during that week publication. (So if an event
from January has been modified in April, when users request data from
April they will find the modified January event) (<strong>check this bit
please</strong>)</li>
</ul>
</li>
<li>Deletion of events
<ul>
<li>While the least common of these three, deletion of events is
something that also happens in our data set. This comes from new
information that may appear which makes the event no longer fit the
scope of ACLED’s data set, or in cases where we merge events to avoid
duplication after new information rises. In these cases, the event is
removed, as well as its event_id_cnty.</li>
</ul>
</li>
</ul>
<p>For users with a personal ACLED file, which appends/adds events
regularly (e.g weekly or monthly), there is a need to check which events
are no longer in the data set. Otherwise, Users risk having an outdated
version of the dataset. To satisfy this need, users can use the
acled_deletion_api() function to gather the event_id_cnty of deleted
events. While users can find an example below, we kindly suggest you to
visit our <a href="https://acleddata.com/download/35179/" class="external-link">guide</a>
.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this section we will show how to use the acled_deletions_api() to
keep our data sets updated. For the examples we will make the following
assumptions:</p>
<p>1. Our data sets are saved as a .rda file.</p>
<p>2. We don’t know if our data sets contains deleted data or not.</p>
<div class="section level3">
<h3 id="dataset-n1">Dataset n°1<a class="anchor" aria-label="anchor" href="#dataset-n1"></a>
</h3>
<p>First lets load the first dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/billingtt/acledR" class="external-link">acledR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/acled_access.html">acled_access</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">"acledexamples@gmail.com"</span>, key <span class="op">=</span> <span class="st">"M3PWwg3DIdhHMuDiilp5"</span><span class="op">)</span> <span class="co">#  This is an example, you will need to input your credentials.</span></span></code></pre></div>
<pre><code><span><span class="co">## Success! Credentials authorized</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Success! Credentials authorized"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">argen_dummy_acled_file</span> <span class="op">&lt;-</span> <span class="fu">acledR</span><span class="fu">::</span><span class="va"><a href="../reference/acled_deletion_old_dummy.html">acled_deletion_old_dummy</a></span> <span class="co"># Here is our old personal ACLED dataset</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">argen_dummy_acled_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 326</span></span></code></pre>
<p>We can see then that our dataset consists of 326 rows or 326 events.
A relatively smaller dataset and its data was gathered on the 25th of
July 2022.</p>
<p>Lets check if there are any deleted events since then.</p>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">137157</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): event_id_cnty</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (1): deleted_timestamp</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">acled_deleted_events</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 137,157</span></span>
<span><span class="co">## Columns: 2</span></span>
<span><span class="co">## $ event_id_cnty     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DRC28840", "IRQ44818", "IRQ44821", "KOR27451", "DRC…</span></span>
<span><span class="co">## $ deleted_timestamp <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1677528650, 1677532023, 1677532023, 1677604460, 1677…</span></span></code></pre>
<p>Quite a lot of deleted events, 137157. Lets check if any of these are
part of my dataset.</p>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<p>As shown by the number of rows (0), there are no deleted events! …
But it is always important to check. Lets go to another example where we
may not be that lucky.</p>
</div>
<div class="section level3">
<h3 id="dataset-n2">Dataset n°2<a class="anchor" aria-label="anchor" href="#dataset-n2"></a>
</h3>
<p>Now lets load our second dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy_acled_file</span> <span class="op">&lt;-</span> <span class="fu">acledR</span><span class="fu">::</span><span class="va"><a href="../reference/acled_deletion_old_dummy_n3.html">acled_deletion_old_dummy_n3</a></span> <span class="co"># Here is our personal ACLED dataset</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dummy_acled_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9000</span></span></code></pre>
<p>With this we have loaded the dataset, and we can see that there are
9000 events in it. Now we proceed to retrieve the deleted events since
the last time we gather data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deleted_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/acled_deletions_api.html">acled_deletions_api</a></span><span class="op">(</span>date_deleted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dummy_acled_file</span><span class="op">$</span><span class="va">timestamp</span><span class="op">)</span><span class="op">)</span> <span class="co"># We are using the largest Unix timestamp as that is the last time we gathered data. </span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">1414</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): event_id_cnty</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (1): deleted_timestamp</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">deleted_events</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1414</span></span></code></pre>
<p>As we can see 1414 events have been removed since the last time I
uploaded my data. Now that we know there are deleted events, lets check
if any of these are in my dataset.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated_dataset</span> <span class="op">&lt;-</span> <span class="va">dummy_acled_file</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">event_id_cnty</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">deleted_events</span><span class="op">$</span><span class="va">event_id_cnty</span><span class="op">)</span><span class="op">)</span> <span class="co"># We exclude every event_id_cnty that also appears in the deleted_events result</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">updated_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8977</span></span></code></pre>
<p>As you can see there were deleted events, and we have excluded them
through the dplyr::filter() function. Now our dataset has only 8977
rows, thus 23 events were deleted.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Trey Billing, Lucas Fagliano, Rachel Goodman, Katayoun Kishi, Michael Start, ACLED.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
